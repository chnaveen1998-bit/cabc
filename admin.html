<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <h1 class="brand">
        <a href="/" style="text-decoration:none;color:inherit">
          <span class="lang-te">సీ.ఏ.బీ.సీ</span>
          <span class="lang-en">C.A.B.C</span>
        </a>
      </h1>

      <nav class="nav">
        <a href="/index.html#songbook"><span class="lang-te">కీర్తనల పుస్తకం</span><span class="lang-en">Song Book</span></a>
        <a href="/index.html#sermons"><span class="lang-te">ప్రసంగాలు</span><span class="lang-en">Sermons</span></a>
        <a href="/index.html#events"><span class="lang-te">గ్యాలరీ</span><span class="lang-en">Gallery</span></a>
        <a href="/index.html#calendar"><span class="lang-te">క్యాలెండర్</span><span class="lang-en">Calendar</span></a>
        <a href="/index.html#prayer"><span class="lang-te">ప్రార్థనా వినతులు</span><span class="lang-en">Prayer Request</span></a>

        <div class="nav-item dropdown">
          <button class="dropdown-toggle btn shortcut" aria-haspopup="true" aria-expanded="false">
            <span class="lang-te">నిర్వహణ</span>
            <span class="lang-en">Admin</span>
            <span class="caret" aria-hidden="true">▾</span>
          </button>
          <div class="dropdown-menu" role="menu">
            <a role="menuitem" href="/pastor.html"><span class="lang-te">పాస్టర్</span><span class="lang-en">Pastor</span></a>
            <a role="menuitem" href="/executive-council.html"><span class="lang-te">నిర్వాహక మండలి</span><span class="lang-en">Church Council</span></a>
            <a role="menuitem" href="/general-body.html"><span class="lang-te">చర్చి సభ్యులు</span><span class="lang-en">Church Members</span></a>
            <a role="menuitem" href="#" id="adminLoginLink"><span class="lang-te">ప్రశాసక లాగిన్</span><span class="lang-en">Admin Login</span></a>
          </div>
        </div>
      </nav>

      <!-- Language switch -->
      <button id="langToggle" class="btn lang-switch" aria-label="Change language">
        <span class="lang-te">English</span>
        <span class="lang-en">తెలుగు</span>
      </button>

      <button class="menu-toggle" aria-label="Toggle menu">☰</button>
    </div>
  </header>

  <div class="container" style="padding:2rem;max-width:800px">
    <h1>Admin Dashboard</h1>
    <div id="adminInfo">Checking login status...</div>
    <div style="margin-top:1rem">
      <button id="adminLogout" class="btn">Logout</button>
      <a href="/" class="btn">Back to site</a>
    </div>
  </div>
  <script>
    async function check(){
      try{
        const r = await fetch('/auth/me');
        const j = await r.json();
        const info = document.getElementById('adminInfo');
        if(j && j.user){
          info.innerHTML = '<p>Signed in as: <strong>' + (j.user.email || j.user.name || 'user') + '</strong></p>' + (j.user.admin ? '<p><em>Admin privileges</em></p>' : '');
        }else{
          info.innerHTML = '<p>You are not signed in. <a href="/">Return to site and sign in.</a></p>';
        }
      }catch(e){ document.getElementById('adminInfo').textContent = 'Unable to check login status'; }
    }
    document.getElementById('adminLogout').addEventListener('click', async ()=>{
      await fetch('/auth/logout', {method:'POST'}).catch(()=>{});
      window.location.href = '/';
    });
    check();
  </script>
  <script src="js/main.js"></script>
</body>
</html>